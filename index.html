<!-- CONTENEUR -->
<div style="max-width:620px;margin:40px auto;padding:32px;background:#fff;border-radius:20px;
            box-shadow:0 10px 30px rgba(0,0,0,0.07);font-family:'Segoe UI',sans-serif;color:#1a1a1a;">

  <!-- TITRE -->
  <h2 style="text-align:center;font-size:24px;font-weight:700;margin-bottom:30px;color:#5a52ff;">
    Signalez une coupure d’électricité dans votre ville
  </h2>

  <!-- CHAMP VILLE -->
  <label for="ville" style="font-weight:600;display:block;margin-bottom:8px;">Votre ville</label>
  <input id="ville" type="text" placeholder="Ex. : Lyon"
         style="width:100%;padding:14px 16px;border:1px solid #ccc;border-radius:10px;
                font-size:16px;margin-bottom:28px;box-sizing:border-box;">

  <!-- CHOIX OUI/NON -->
  <label style="font-weight:600;display:block;margin-bottom:12px;">Avez-vous eu une coupure ?</label>
  <div style="display:flex;gap:20px;margin-bottom:32px;">
    <label class="opt" data-value="Oui" 
           style="flex:1;background:#f1f3ff;padding:14px 16px;border-radius:10px;
                  text-align:center;cursor:pointer;border:2px solid transparent;
                  transition:border-color .2s;">
      Oui
    </label>
    <label class="opt" data-value="Non" 
           style="flex:1;background:#f1f3ff;padding:14px 16px;border-radius:10px;
                  text-align:center;cursor:pointer;border:2px solid transparent;
                  transition:border-color .2s;">
      Non
    </label>
  </div>

  <!-- BOUTON -->
  <button id="submitBtn" 
          style="width:100%;padding:16px;background:linear-gradient(to right,#5a52ff,#0fc4b2);
                 color:#fff;border:none;border-radius:12px;font-size:17px;font-weight:bold;
                 cursor:pointer;transition:background .3s;">
    Envoyer
  </button>

  <!-- CONFIRMATION -->
  <p id="confirmation" 
     style="display:none;margin-top:20px;color:#5a52ff;text-align:center;font-weight:600;">
    Merci, votre réponse a bien été envoyée !
  </p>
</div>

<!-- GOOGLE MAPS LIB + SCRIPT -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD-rJWgZwUxtjsLZ-w0VPOG2e4fVUmJGNA&libraries=places"></script>
<script>
  let villeValide = "";
  let choixCoupure = "";

  document.addEventListener("DOMContentLoaded", () => {
    const inputVille = document.getElementById("ville");
    const opts = document.querySelectorAll(".opt");
    const btn = document.getElementById("submitBtn");

    // 1) Active autocomplete au focus
    inputVille.addEventListener("focus", () => {
      if (inputVille.autocompleteInstance) return;
      inputVille.autocompleteInstance = new google.maps.places.Autocomplete(inputVille, {
        types: ["(cities)"],
        componentRestrictions: { country: "fr" }
      });
      inputVille.autocompleteInstance.setFields(["name"]);
      inputVille.autocompleteInstance.addListener("place_changed", () => {
        const place = inputVille.autocompleteInstance.getPlace();
        villeValide = place.name || "";
      });
      inputVille.addEventListener("input", () => villeValide = "");
    });

    // 2) Gère la sélection Oui/Non
    opts.forEach(label => {
      label.addEventListener("click", () => {
        choixCoupure = label.dataset.value;
        opts.forEach(l => l.style.borderColor = "transparent");
        label.style.borderColor = "#ffb81d";
      });
    });

    // 3) Envoi du formulaire
    btn.addEventListener("click", () => {
      const textVille = inputVille.value;
      if (!textVille || !choixCoupure || textVille !== villeValide) {
        alert("Veuillez sélectionner une ville valide et répondre à la question.");
        return;
      }
      fetch("TON_URL_APPS_SCRIPT", {
        method: "POST", mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ ville: villeValide, coupure: choixCoupure })
      });
      inputVille.value = "";
      choixCoupure = "";
      opts.forEach(l => l.style.borderColor = "transparent");
      document.getElementById("confirmation").style.display = "block";
    });
  });
</script>
